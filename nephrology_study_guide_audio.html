<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>üéß Nephrology Study Guide ‚Äî Audio Edition</title>
    <style>
        :root {
            --primary: #0969da;
            --primary-light: #54aeff;
            --accent: #e07b53;
            --bg: #1a1a2e;
            --card-bg: #16213e;
            --text: #e8e8e8;
            --text-muted: #a0a0a0;
            --border: #2a2a4a;
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            min-height: 100vh;
        }
        
        .header {
            text-align: center;
            padding: 30px 20px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border-radius: 16px;
            margin-bottom: 20px;
        }
        
        .header h1 { font-size: 1.8rem; margin-bottom: 8px; }
        .header p { opacity: 0.9; }
        
        /* Controls */
        .controls {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
            position: sticky;
            top: 10px;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        
        .main-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: var(--primary);
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .control-btn:hover { transform: scale(1.1); }
        .control-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .control-btn.play-btn { width: 70px; height: 70px; font-size: 1.8rem; }
        
        .progress-container {
            background: var(--border);
            border-radius: 10px;
            height: 8px;
            margin-bottom: 15px;
            cursor: pointer;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--primary);
            border-radius: 10px;
            width: 0%;
            transition: width 0.3s;
        }
        
        .progress-text {
            text-align: center;
            font-size: 0.9rem;
            color: var(--text-muted);
        }
        
        .settings-row {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .setting-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .setting-group label {
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        
        .setting-group select, .setting-group input {
            padding: 6px 10px;
            background: var(--bg);
            color: var(--text);
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        /* Voice Selector */
        .voice-selector {
            margin-bottom: 20px;
            padding: 15px;
            background: var(--card-bg);
            border-radius: 12px;
        }
        
        .voice-selector label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-muted);
            font-size: 0.9rem;
        }
        
        .voice-selector select {
            width: 100%;
            padding: 10px;
            background: var(--bg);
            color: var(--text);
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
        }
        
        /* Table of Contents */
        .toc {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .toc h2 { margin-bottom: 15px; font-size: 1.1rem; }
        
        .toc-item {
            padding: 10px 15px;
            margin: 5px 0;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .toc-item:hover { background: rgba(255,255,255,0.08); }
        .toc-item.active { background: var(--primary); }
        
        .toc-duration {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .toc-new {
            background: #2da44e;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.7rem;
            margin-left: 8px;
        }
        
        /* Content sections */
        .section {
            background: var(--card-bg);
            border-radius: 12px;
            margin-bottom: 15px;
            overflow: hidden;
        }
        
        .section-header {
            padding: 15px 20px;
            background: rgba(255,255,255,0.05);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-header:hover { background: rgba(255,255,255,0.08); }
        
        .section-content {
            padding: 20px;
            display: none;
        }
        
        .section.active .section-content { display: block; }
        
        .speakable {
            margin-bottom: 12px;
            padding: 8px 12px;
            border-left: 3px solid transparent;
            transition: all 0.2s;
        }
        
        .speakable.speaking {
            background: rgba(9, 105, 218, 0.2);
            border-left-color: var(--primary);
        }
        
        .topic { margin-bottom: 25px; }
        .topic-title {
            font-weight: 600;
            color: var(--primary-light);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .content-block {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .block-label {
            font-size: 0.8rem;
            color: var(--accent);
            margin-bottom: 8px;
            text-transform: uppercase;
        }
        
        /* Responsive */
        @media (max-width: 600px) {
            body { font-size: 16px; padding: 15px; }
            .settings-row { gap: 10px; }
            .control-btn { width: 44px; height: 44px; }
            .control-btn.play-btn { width: 56px; height: 56px; }
        }
    </style>
</head>
<body>

<div class="header">
    <h1>üéß Nephrology Study Guide</h1>
    <p>Audio Edition ‚Ä¢ ABIM Board Review</p>
    <p style="font-size:0.8rem; opacity:0.7; margin-top:8px;">v1.1 BUILD #9 ‚Äî 18 Chapters (~75 min)</p>
</div>

<div class="voice-selector">
    <label>üéôÔ∏è Select Voice (English only):</label>
    <select id="voiceSelect"></select>
</div>

<div class="controls">
    <div class="main-controls">
        <button class="control-btn" id="prevBtn" title="Previous">‚èÆ</button>
        <button class="control-btn" id="backBtn" title="Back 15s">‚Ü∫15</button>
        <button class="control-btn play-btn" id="playBtn" title="Play/Pause">‚ñ∂</button>
        <button class="control-btn" id="fwdBtn" title="Forward 15s">15‚Üª</button>
        <button class="control-btn" id="nextBtn" title="Next">‚è≠</button>
    </div>
    
    <div class="progress-container" id="progressContainer">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    <div class="progress-text" id="progressText">Ready to play</div>
    
    <div class="settings-row">
        <div class="setting-group">
            <label>Speed:</label>
            <select id="speedSelect">
                <option value="0.75">0.75√ó</option>
                <option value="1" selected>1√ó</option>
                <option value="1.25">1.25√ó</option>
                <option value="1.5">1.5√ó</option>
                <option value="2">2√ó</option>
            </select>
        </div>
        <div class="setting-group">
            <label>Pause (ms):</label>
            <input type="number" id="pauseInput" value="400" min="0" max="2000" step="100" style="width:70px;">
        </div>
    </div>
</div>

<div class="toc">
    <h2>üìã Chapters (18 total)</h2>
    <div class="toc-item" data-section="0"><span>1. Acute Kidney Injury</span><span class="toc-duration">~5 min</span></div>
    <div class="toc-item" data-section="1"><span>2. ATN, AIN & Contrast</span><span class="toc-duration">~5 min</span></div>
    <div class="toc-item" data-section="2"><span>3. Rhabdomyolysis<span class="toc-new">NEW</span></span><span class="toc-duration">~5 min</span></div>
    <div class="toc-item" data-section="3"><span>4. Myeloma Kidney<span class="toc-new">NEW</span></span><span class="toc-duration">~4 min</span></div>
    <div class="toc-item" data-section="4"><span>5. Glomerulonephritis Overview</span><span class="toc-duration">~4 min</span></div>
    <div class="toc-item" data-section="5"><span>6. Nephrotic Syndrome</span><span class="toc-duration">~5 min</span></div>
    <div class="toc-item" data-section="6"><span>7. Nephritic & RPGN</span><span class="toc-duration">~5 min</span></div>
    <div class="toc-item" data-section="7"><span>8. Post-Infectious GN<span class="toc-new">NEW</span></span><span class="toc-duration">~4 min</span></div>
    <div class="toc-item" data-section="8"><span>9. MPGN<span class="toc-new">NEW</span></span><span class="toc-duration">~4 min</span></div>
    <div class="toc-item" data-section="9"><span>10. CKD & Complications</span><span class="toc-duration">~5 min</span></div>
    <div class="toc-item" data-section="10"><span>11. Hyponatremia</span><span class="toc-duration">~6 min</span></div>
    <div class="toc-item" data-section="11"><span>12. Hyperkalemia & Hypokalemia</span><span class="toc-duration">~5 min</span></div>
    <div class="toc-item" data-section="12"><span>13. Acid-Base Approach</span><span class="toc-duration">~5 min</span></div>
    <div class="toc-item" data-section="13"><span>14. Respiratory Acid-Base<span class="toc-new">NEW</span></span><span class="toc-duration">~4 min</span></div>
    <div class="toc-item" data-section="14"><span>15. Mixed Acid-Base<span class="toc-new">NEW</span></span><span class="toc-duration">~5 min</span></div>
    <div class="toc-item" data-section="15"><span>16. RTA</span><span class="toc-duration">~4 min</span></div>
    <div class="toc-item" data-section="16"><span>17. Hematuria Workup<span class="toc-new">NEW</span></span><span class="toc-duration">~4 min</span></div>
    <div class="toc-item" data-section="17"><span>18. Dialysis & Transplant</span><span class="toc-duration">~4 min</span></div>
</div>

<!-- AUDIO CONTENT -->
<div id="audioContent">

<!-- SECTION 0: AKI -->
<div class="section" data-section="0">
    <div class="section-header" onclick="jumpToSection(0)"><span>1. Acute Kidney Injury</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">AKI Definition</div>
            <p class="speakable">Acute kidney injury is defined by KDIGO criteria as any of the following.</p>
            <p class="speakable">First, an increase in serum creatinine by 0.3 milligrams per deciliter or more within 48 hours.</p>
            <p class="speakable">Second, an increase in serum creatinine to 1.5 times baseline or more within 7 days.</p>
            <p class="speakable">Third, urine output less than 0.5 milliliters per kilogram per hour for 6 hours or more.</p>
        </div>
        <div class="topic">
            <div class="topic-title">KDIGO Staging</div>
            <p class="speakable">Stage 1 AKI is creatinine 1.5 to 1.9 times baseline, or an increase of 0.3 or more.</p>
            <p class="speakable">Stage 2 AKI is creatinine 2 to 2.9 times baseline.</p>
            <p class="speakable">Stage 3 AKI is creatinine 3 times baseline or greater, or creatinine 4 or greater, or initiation of dialysis.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Prerenal vs Intrinsic vs Postrenal</div>
            <p class="speakable">Prerenal AKI is caused by decreased renal perfusion. Causes include hypovolemia, heart failure, cirrhosis, and medications like NSAIDs and ACE inhibitors.</p>
            <p class="speakable">In prerenal AKI, FENa is less than 1%, BUN to creatinine ratio is greater than 20, and sediment is bland with hyaline casts.</p>
            <p class="speakable">Intrinsic AKI involves direct kidney damage. Causes include ATN, AIN, and glomerulonephritis.</p>
            <p class="speakable">In intrinsic AKI, FENa is greater than 2%, BUN to creatinine ratio is 10 to 15, and sediment shows casts.</p>
            <p class="speakable">Postrenal AKI is caused by urinary tract obstruction. Causes include BPH, kidney stones, and tumors.</p>
        </div>
        <div class="topic">
            <div class="topic-title">FENa Calculation</div>
            <p class="speakable">FENa equals urine sodium times plasma creatinine, divided by plasma sodium times urine creatinine, times 100.</p>
            <p class="speakable">FENa less than 1% suggests prerenal. FENa greater than 2% suggests intrinsic.</p>
            <p class="speakable">Board pearl: FENa less than 1% can also be seen in contrast nephropathy, rhabdomyolysis, early obstruction, and acute GN.</p>
            <p class="speakable">If the patient is on diuretics, use FEUrea instead. FEUrea less than 35% suggests prerenal.</p>
        </div>
    </div>
</div>

<!-- SECTION 1: ATN, AIN, Contrast -->
<div class="section" data-section="1">
    <div class="section-header" onclick="jumpToSection(1)"><span>2. ATN, AIN & Contrast</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Acute Tubular Necrosis</div>
            <p class="speakable">ATN is the most common cause of intrinsic AKI.</p>
            <p class="speakable">Ischemic ATN is caused by prolonged prerenal states, sepsis, surgery, or hemorrhage.</p>
            <p class="speakable">Nephrotoxic ATN is caused by aminoglycosides, amphotericin, cisplatin, and contrast.</p>
            <p class="speakable">Pigment-induced ATN is caused by rhabdomyolysis or hemolysis.</p>
            <p class="speakable">ATN has 3 phases. Initiation when injury occurs. Maintenance with oliguria and peak creatinine over 1 to 2 weeks. Recovery with polyuria and falling creatinine.</p>
            <p class="speakable">The pathognomonic finding on urinalysis is muddy brown granular casts.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Acute Interstitial Nephritis</div>
            <p class="speakable">AIN is a boards favorite topic. It is caused by drugs in over 70% of cases.</p>
            <p class="speakable">Common drug causes include NSAIDs, PPIs, beta-lactams, fluoroquinolones, sulfonamides, rifampin, and allopurinol.</p>
            <p class="speakable">The classic triad is fever, rash, and eosinophilia. But this triad is only present in about 10% of cases.</p>
            <p class="speakable">Urinalysis shows WBC casts and sterile pyuria. Urine eosinophils have poor sensitivity at only 30%.</p>
            <p class="speakable">Treatment is to stop the offending agent. If no improvement after 5 to 7 days, consider steroids.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Contrast-Induced Nephropathy</div>
            <p class="speakable">The most important risk factor for contrast nephropathy is pre-existing CKD, especially with diabetes.</p>
            <p class="speakable">For prevention, IV isotonic saline has proven benefit. Low-osmolar contrast is preferred.</p>
            <p class="speakable">Board pearl: The PRESERVE trial showed that N-acetylcysteine and sodium bicarbonate are NOT superior to saline alone.</p>
        </div>
    </div>
</div>

<!-- SECTION 2: Rhabdomyolysis (NEW) -->
<div class="section" data-section="2">
    <div class="section-header" onclick="jumpToSection(2)"><span>3. Rhabdomyolysis</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Definition and Causes</div>
            <p class="speakable">Rhabdomyolysis is skeletal muscle breakdown releasing myoglobin, CK, potassium, phosphorus, and uric acid into the bloodstream.</p>
            <p class="speakable">Causes can be remembered with the mnemonic RHABDO.</p>
            <p class="speakable">R is for rest and immobilization, including prolonged immobilization and crush injuries.</p>
            <p class="speakable">H is for hyperthermia, hypothermia, hypokalemia, and hypophosphatemia.</p>
            <p class="speakable">A is for alcohol and amphetamines.</p>
            <p class="speakable">B is for bacterial and viral infections like influenza and Legionella.</p>
            <p class="speakable">D is for drugs including statins, colchicine, antipsychotics, and cocaine.</p>
            <p class="speakable">O is for overexertion from marathons, seizures, or status epilepticus.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Clinical Features and Labs</div>
            <p class="speakable">Clinical features include muscle pain, weakness, and dark tea-colored urine.</p>
            <p class="speakable">CK greater than 5 times the upper limit of normal is diagnostic. CK often exceeds 10,000 and peaks at 24 to 72 hours.</p>
            <p class="speakable">Potassium is elevated from cell release and can be severe.</p>
            <p class="speakable">Calcium is LOW because it deposits in damaged muscle.</p>
            <p class="speakable">Phosphorus and uric acid are elevated from cell breakdown.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Urinalysis Finding - Board Pearl</div>
            <p class="speakable">The classic urinalysis finding is dipstick positive for blood, but NO red blood cells on microscopy.</p>
            <p class="speakable">This is because the dipstick detects heme, and myoglobin cross-reacts with hemoglobin on the dipstick.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Treatment</div>
            <p class="speakable">The mainstay of treatment is aggressive IV fluids, typically normal saline at 200 to 300 mL per hour.</p>
            <p class="speakable">The goal urine output is 200 to 300 mL per hour.</p>
            <p class="speakable">Monitor potassium closely and treat hyperkalemia aggressively.</p>
            <p class="speakable">Avoid giving calcium unless there is symptomatic hypocalcemia or hyperkalemia with ECG changes.</p>
            <p class="speakable">Previously, bicarbonate was used to alkalinize urine, but trials show no clear benefit and it may worsen hypocalcemia.</p>
        </div>
    </div>
</div>

<!-- SECTION 3: Myeloma Kidney (NEW) -->
<div class="section" data-section="3">
    <div class="section-header" onclick="jumpToSection(3)"><span>4. Myeloma Kidney</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Overview</div>
            <p class="speakable">Renal involvement occurs in about 50% of multiple myeloma patients and is a leading cause of morbidity.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Types of Renal Involvement</div>
            <p class="speakable">Cast nephropathy is the most common type. Light chains combine with Tamm-Horsfall protein to cause tubular obstruction.</p>
            <p class="speakable">Light chain deposition disease involves light chains depositing in glomeruli and tubules, causing nephrotic syndrome.</p>
            <p class="speakable">AL amyloidosis involves light chain fibrils depositing as amyloid, also causing nephrotic syndrome.</p>
            <p class="speakable">Hypercalcemia causes AKI through volume depletion and vasoconstriction.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Cast Nephropathy - Key Board Pearl</div>
            <p class="speakable">Cast nephropathy presents as AKI with bland sediment.</p>
            <p class="speakable">Critical board pearl: The urine dipstick is NEGATIVE for protein because the dipstick only detects albumin, not light chains.</p>
            <p class="speakable">However, the 24-hour urine protein or SPEP and UPEP will show significant proteinuria.</p>
            <p class="speakable">If you see dipstick-negative proteinuria with high protein on quantification, think light chains.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Treatment</div>
            <p class="speakable">Treat the underlying myeloma with chemotherapy and consider stem cell transplant.</p>
            <p class="speakable">Give IV fluids to maintain high urine flow. Avoid nephrotoxins. Treat hypercalcemia.</p>
            <p class="speakable">Plasmapheresis may help in severe cast nephropathy, though this is controversial.</p>
        </div>
    </div>
</div>

<!-- SECTION 4: GN Overview -->
<div class="section" data-section="4">
    <div class="section-header" onclick="jumpToSection(4)"><span>5. Glomerulonephritis Overview</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Nephrotic vs Nephritic</div>
            <p class="speakable">Nephrotic syndrome has proteinuria greater than 3.5 grams per day, hypoalbuminemia, severe edema, and hyperlipidemia.</p>
            <p class="speakable">Nephritic syndrome has less proteinuria, prominent hematuria with RBC casts, hypertension, and mild edema.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Complement Levels - High Yield</div>
            <p class="speakable">Diseases with LOW complement include post-infectious GN, lupus nephritis, MPGN, cryoglobulinemia, and endocarditis-associated GN.</p>
            <p class="speakable">Diseases with NORMAL complement include IgA nephropathy, ANCA vasculitis, anti-GBM disease, FSGS, MCD, and membranous.</p>
            <p class="speakable">Board pearl: Low C3 with low C4 indicates classic pathway activation, seen in lupus and cryoglobulinemia.</p>
            <p class="speakable">Low C3 with normal C4 indicates alternative pathway activation, seen in post-infectious GN and MPGN.</p>
        </div>
    </div>
</div>

<!-- SECTION 5: Nephrotic Syndrome -->
<div class="section" data-section="5">
    <div class="section-header" onclick="jumpToSection(5)"><span>6. Nephrotic Syndrome</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Definition and Causes</div>
            <p class="speakable">Nephrotic syndrome has 4 features. Proteinuria greater than 3.5 grams per 24 hours. Hypoalbuminemia less than 3. Edema. Hyperlipidemia.</p>
            <p class="speakable">The most common cause in children is minimal change disease.</p>
            <p class="speakable">In Black adults, FSGS is most common. In White adults, membranous is most common.</p>
            <p class="speakable">In diabetics, diabetic nephropathy is most common. In the elderly, think membranous or amyloidosis.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Complications</div>
            <p class="speakable">Thromboembolism is a major complication due to loss of antithrombin III. Renal vein thrombosis is classically associated with membranous nephropathy.</p>
            <p class="speakable">Infection risk increases due to loss of immunoglobulins in the urine.</p>
        </div>
    </div>
</div>

<!-- SECTION 6: Nephritic & RPGN -->
<div class="section" data-section="6">
    <div class="section-header" onclick="jumpToSection(6)"><span>7. Nephritic & RPGN</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Nephritic Features</div>
            <p class="speakable">Nephritic syndrome features include hematuria with dysmorphic RBCs and RBC casts, hypertension, oliguria, and mild proteinuria.</p>
            <p class="speakable">Board pearl: RBC casts equal glomerulonephritis. They are pathognomonic for glomerular bleeding.</p>
        </div>
        <div class="topic">
            <div class="topic-title">RPGN Classification</div>
            <p class="speakable">RPGN or rapidly progressive GN is classified by immunofluorescence pattern.</p>
            <p class="speakable">Type 1 RPGN shows linear IgG and is caused by anti-GBM disease or Goodpasture syndrome.</p>
            <p class="speakable">Type 2 RPGN shows granular deposits and is caused by lupus, post-infectious GN, IgA, or MPGN.</p>
            <p class="speakable">Type 3 RPGN is pauci-immune with few or no deposits. It is caused by ANCA vasculitis including GPA, MPA, and EGPA.</p>
        </div>
    </div>
</div>

<!-- SECTION 7: Post-Infectious GN (NEW) -->
<div class="section" data-section="7">
    <div class="section-header" onclick="jumpToSection(7)"><span>8. Post-Infectious GN</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Overview</div>
            <p class="speakable">Post-infectious GN is immune complex-mediated GN occurring after infection, classically Group A streptococcus.</p>
            <p class="speakable">It is most common in children ages 2 to 14 but can occur in adults, especially diabetics and immunocompromised patients.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Timing - Key Board Distinction</div>
            <p class="speakable">There is a latent period between infection and GN. After pharyngitis, the latent period is 1 to 3 weeks. After skin infection, it is 3 to 6 weeks.</p>
            <p class="speakable">Board pearl: Post-infectious GN has a latent period. IgA nephropathy is synpharyngitic, meaning hematuria occurs during or within days of the URI.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Labs and Biopsy</div>
            <p class="speakable">C3 is LOW. C4 is normal because this is alternative pathway activation.</p>
            <p class="speakable">ASO titer is elevated after pharyngitis. Anti-DNase B is elevated after skin infection.</p>
            <p class="speakable">Biopsy shows diffuse proliferative GN. IF shows granular starry sky pattern with IgG and C3. EM shows subepithelial humps.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Prognosis</div>
            <p class="speakable">Children have excellent prognosis with over 95% recovering completely.</p>
            <p class="speakable">Adults have higher risk of CKD and persistent hypertension.</p>
            <p class="speakable">Treatment is supportive with BP control, diuretics, and salt restriction. Antibiotics treat active infection but do not prevent GN.</p>
        </div>
    </div>
</div>

<!-- SECTION 8: MPGN (NEW) -->
<div class="section" data-section="8">
    <div class="section-header" onclick="jumpToSection(8)"><span>9. MPGN</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Definition</div>
            <p class="speakable">MPGN or membranoproliferative GN is a pattern of glomerular injury with mesangial proliferation and capillary wall thickening.</p>
            <p class="speakable">Light microscopy shows tram-tracking, which is a double contour of the glomerular basement membrane.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Modern Classification</div>
            <p class="speakable">Immune complex-mediated MPGN has immunoglobulin and C3 deposits. The most common cause is Hepatitis C.</p>
            <p class="speakable">Complement-mediated MPGN, also called C3 glomerulopathy, has C3 only with no immunoglobulins. It is caused by alternative pathway dysregulation.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Hepatitis C-Associated MPGN</div>
            <p class="speakable">Hep C is the most common cause of MPGN. It is often associated with type 2 cryoglobulinemia.</p>
            <p class="speakable">Features include palpable purpura, arthralgias, and neuropathy.</p>
            <p class="speakable">Treatment is direct-acting antivirals for Hepatitis C. This can be curative in many cases.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Complement Pattern</div>
            <p class="speakable">Board pearl: Low C3 with low C4 indicates classic pathway activation, seen in lupus and Hep C with cryoglobulinemia.</p>
            <p class="speakable">Low C3 with normal C4 indicates alternative pathway activation, seen in C3 glomerulopathy.</p>
        </div>
    </div>
</div>

<!-- SECTION 9: CKD -->
<div class="section" data-section="9">
    <div class="section-header" onclick="jumpToSection(9)"><span>10. CKD & Complications</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">CKD Staging</div>
            <p class="speakable">CKD stage 1 is GFR greater than or equal to 90 with kidney damage. Stage 2 is GFR 60 to 89. Stage 3a is GFR 45 to 59. Stage 3b is GFR 30 to 44.</p>
            <p class="speakable">Stage 4 is GFR 15 to 29. Stage 5 is GFR less than 15 or on dialysis.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Slowing Progression</div>
            <p class="speakable">ACE inhibitors or ARBs are first-line for proteinuric CKD. Target blood pressure less than 130/80.</p>
            <p class="speakable">SGLT2 inhibitors have proven renal benefit in CREDENCE, DAPA-CKD, and EMPA-KIDNEY trials.</p>
            <p class="speakable">Finerenone, a nonsteroidal MRA, reduces CKD progression in diabetic kidney disease per FIDELIO-DKD.</p>
        </div>
        <div class="topic">
            <div class="topic-title">CKD-MBD</div>
            <p class="speakable">In CKD, the kidney fails to produce active vitamin D, leading to low calcium and high phosphorus.</p>
            <p class="speakable">PTH rises as a compensatory mechanism, causing secondary hyperparathyroidism.</p>
            <p class="speakable">Treatment includes phosphate binders, active vitamin D, and calcimimetics like cinacalcet.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Anemia of CKD</div>
            <p class="speakable">Caused by decreased erythropoietin production. Give iron first, IV preferred in hemodialysis patients.</p>
            <p class="speakable">Then add ESAs like epoetin or darbepoetin. Target hemoglobin 10 to 11.</p>
            <p class="speakable">Board pearl from TREAT and CHOIR: Targeting hemoglobin greater than 13 with ESAs increases stroke risk with no CV benefit.</p>
        </div>
    </div>
</div>

<!-- SECTION 10: Hyponatremia -->
<div class="section" data-section="10">
    <div class="section-header" onclick="jumpToSection(10)"><span>11. Hyponatremia</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Step 1: Serum Osmolality</div>
            <p class="speakable">First, check serum osmolality. Less than 280 is hypotonic or true hyponatremia.</p>
            <p class="speakable">280 to 295 is isotonic or pseudohyponatremia, caused by hyperlipidemia or hyperproteinemia.</p>
            <p class="speakable">Greater than 295 is hypertonic, caused by hyperglycemia or mannitol.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Step 2: Volume Status</div>
            <p class="speakable">If hypotonic, assess volume status. Hypovolemic hyponatremia with low urine sodium is from GI losses or burns.</p>
            <p class="speakable">Hypovolemic hyponatremia with high urine sodium is from diuretics or salt-wasting nephropathy.</p>
            <p class="speakable">Euvolemic hyponatremia with high urine sodium is SIADH, hypothyroidism, or adrenal insufficiency.</p>
            <p class="speakable">Hypervolemic hyponatremia with low urine sodium is CHF or cirrhosis. With high urine sodium is CKD.</p>
        </div>
        <div class="topic">
            <div class="topic-title">SIADH Criteria</div>
            <p class="speakable">SIADH requires serum osmolality less than 275, urine osmolality greater than 100, urine sodium greater than 30, euvolemia, and normal thyroid and adrenal function.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Treatment</div>
            <p class="speakable">Correction rate must be 8 to 10 mEq per liter or less per 24 hours. Faster correction risks osmotic demyelination syndrome.</p>
            <p class="speakable">For acute symptomatic hyponatremia, give 3% saline to raise sodium 4 to 6 mEq in the first few hours.</p>
            <p class="speakable">For SIADH, use fluid restriction, salt tablets, or vaptans.</p>
        </div>
    </div>
</div>

<!-- SECTION 11: Hyperkalemia & Hypokalemia -->
<div class="section" data-section="11">
    <div class="section-header" onclick="jumpToSection(11)"><span>12. Hyperkalemia & Hypokalemia</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Hyperkalemia Causes</div>
            <p class="speakable">Hyperkalemia can result from transcellular shift, decreased excretion, or medications.</p>
            <p class="speakable">Shift causes include acidosis, insulin deficiency, beta-blockers, and cell lysis.</p>
            <p class="speakable">Decreased excretion occurs in AKI, CKD, and hypoaldosteronism.</p>
            <p class="speakable">Drug causes include ACE inhibitors, ARBs, spironolactone, and trimethoprim.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Hyperkalemia ECG Changes</div>
            <p class="speakable">ECG changes progress with increasing potassium. First peaked T waves. Then PR prolongation and flat P waves. Then QRS widening. Finally sine wave leading to VF or asystole.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Hyperkalemia Treatment</div>
            <p class="speakable">First give IV calcium gluconate to stabilize the myocardium. This works within minutes.</p>
            <p class="speakable">Then give insulin with glucose to shift potassium into cells. This works in 15 to 30 minutes.</p>
            <p class="speakable">Albuterol also causes shift. Give loop diuretics for excretion. Patiromer or SZC for GI binding. Dialysis for severe cases.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Hypokalemia</div>
            <p class="speakable">Hypokalemia causes include shift from insulin or beta-agonists, GI losses from vomiting or diarrhea, and renal losses from diuretics or hyperaldosteronism.</p>
            <p class="speakable">ECG shows flattened T waves, U waves, and ST depression.</p>
            <p class="speakable">Board pearl: Always check magnesium. Hypomagnesemia causes refractory hypokalemia.</p>
        </div>
    </div>
</div>

<!-- SECTION 12: Acid-Base Approach -->
<div class="section" data-section="12">
    <div class="section-header" onclick="jumpToSection(12)"><span>13. Acid-Base Approach</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">5-Step Approach</div>
            <p class="speakable">Step 1: Is it acidemia with pH less than 7.35 or alkalemia with pH greater than 7.45?</p>
            <p class="speakable">Step 2: Identify the primary disorder using pCO2 and bicarbonate.</p>
            <p class="speakable">Step 3: Calculate expected compensation.</p>
            <p class="speakable">Step 4: If metabolic acidosis, calculate the anion gap.</p>
            <p class="speakable">Step 5: If anion gap acidosis, calculate the delta-delta ratio.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Anion Gap</div>
            <p class="speakable">Anion gap equals sodium minus chloride plus bicarbonate. Normal is 8 to 12.</p>
            <p class="speakable">Correct for albumin: add 2.5 for each 1 gram per deciliter decrease in albumin.</p>
            <p class="speakable">High anion gap acidosis causes can be remembered with GOLDMARK: Glycols, Oxoproline, L-lactate, D-lactate, Methanol, Aspirin, Renal failure, Ketoacidosis.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Compensation Formulas</div>
            <p class="speakable">For metabolic acidosis, expected pCO2 equals 1.5 times bicarbonate plus 8, plus or minus 2.</p>
            <p class="speakable">For metabolic alkalosis, expected pCO2 equals 0.7 times bicarbonate plus 21, plus or minus 2.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Delta-Delta Ratio</div>
            <p class="speakable">Delta-delta equals the change in anion gap divided by the change in bicarbonate.</p>
            <p class="speakable">Less than 1 indicates concurrent non-anion gap acidosis. 1 to 2 indicates pure anion gap acidosis. Greater than 2 indicates concurrent metabolic alkalosis.</p>
        </div>
    </div>
</div>

<!-- SECTION 13: Respiratory Acid-Base (NEW) -->
<div class="section" data-section="13">
    <div class="section-header" onclick="jumpToSection(13)"><span>14. Respiratory Acid-Base</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Respiratory Acidosis</div>
            <p class="speakable">Respiratory acidosis is pCO2 greater than 45 with acidemia. It is caused by hypoventilation.</p>
            <p class="speakable">CNS causes include opioids, sedatives, stroke, and encephalopathy.</p>
            <p class="speakable">Neuromuscular causes include Guillain-Barr√©, myasthenia gravis, and ALS.</p>
            <p class="speakable">Chest wall causes include kyphoscoliosis and obesity hypoventilation syndrome.</p>
            <p class="speakable">Airway causes include severe COPD and asthma.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Respiratory Acidosis Compensation</div>
            <p class="speakable">In acute respiratory acidosis, bicarbonate increases 1 for every 10 increase in pCO2.</p>
            <p class="speakable">In chronic respiratory acidosis, bicarbonate increases 3.5 for every 10 increase in pCO2.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Respiratory Alkalosis</div>
            <p class="speakable">Respiratory alkalosis is pCO2 less than 35 with alkalemia. It is caused by hyperventilation.</p>
            <p class="speakable">Hypoxia-driven causes include high altitude, pneumonia, PE, and pulmonary edema.</p>
            <p class="speakable">CNS causes include anxiety, pain, fever, meningitis, and salicylate toxicity.</p>
            <p class="speakable">Other causes include pregnancy, hyperthyroidism, and liver failure.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Respiratory Alkalosis Compensation</div>
            <p class="speakable">In acute respiratory alkalosis, bicarbonate decreases 2 for every 10 decrease in pCO2.</p>
            <p class="speakable">In chronic respiratory alkalosis, bicarbonate decreases 5 for every 10 decrease in pCO2.</p>
        </div>
    </div>
</div>

<!-- SECTION 14: Mixed Acid-Base (NEW) -->
<div class="section" data-section="14">
    <div class="section-header" onclick="jumpToSection(14)"><span>15. Mixed Acid-Base</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">When to Suspect Mixed Disorder</div>
            <p class="speakable">Suspect a mixed acid-base disorder when compensation is more or less than expected.</p>
            <p class="speakable">Also suspect it when pH is normal but pCO2 and bicarbonate are both abnormal.</p>
            <p class="speakable">Also suspect it when delta-delta ratio is abnormal.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Common Mixed Disorders</div>
            <p class="speakable">Anion gap metabolic acidosis with respiratory alkalosis is seen in salicylate toxicity and sepsis.</p>
            <p class="speakable">Anion gap acidosis with metabolic alkalosis is seen in DKA with vomiting. The delta-delta will be greater than 2.</p>
            <p class="speakable">Anion gap acidosis with non-anion gap acidosis is seen in DKA after normal saline resuscitation. The delta-delta will be less than 1.</p>
            <p class="speakable">Metabolic alkalosis with respiratory alkalosis is seen in COPD patients on diuretics or in liver disease. The pH is markedly elevated.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Salicylate Toxicity - Classic Board Question</div>
            <p class="speakable">Salicylate toxicity is a classic mixed disorder. Early toxicity causes respiratory alkalosis from direct CNS stimulation.</p>
            <p class="speakable">Late toxicity causes anion gap metabolic acidosis.</p>
            <p class="speakable">The classic ABG shows a normal pH with low pCO2 and low bicarbonate with an elevated anion gap.</p>
        </div>
    </div>
</div>

<!-- SECTION 15: RTA -->
<div class="section" data-section="15">
    <div class="section-header" onclick="jumpToSection(15)"><span>16. Renal Tubular Acidosis</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Overview</div>
            <p class="speakable">RTAs cause non-anion gap metabolic acidosis. The key is to remember the urine pH and potassium for each type.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Type 1 - Distal RTA</div>
            <p class="speakable">Type 1 RTA is distal RTA. The distal tubule cannot secrete hydrogen ions.</p>
            <p class="speakable">Urine pH is greater than 5.5 because H+ cannot be secreted. Potassium is LOW.</p>
            <p class="speakable">Associated with Sj√∂gren syndrome, amphotericin, and lithium. Causes nephrocalcinosis and kidney stones.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Type 2 - Proximal RTA</div>
            <p class="speakable">Type 2 RTA is proximal RTA. The proximal tubule cannot reabsorb bicarbonate.</p>
            <p class="speakable">Urine pH is variable. Potassium is LOW. Associated with Fanconi syndrome with glucosuria, phosphaturia, and aminoaciduria.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Type 4 - Hypoaldo RTA</div>
            <p class="speakable">Type 4 RTA is hypoaldosteronism RTA. There is decreased aldosterone effect.</p>
            <p class="speakable">Urine pH is less than 5.5. Potassium is HIGH. This is the key distinguishing feature.</p>
            <p class="speakable">Type 4 is the most common RTA. Causes include diabetic nephropathy and drugs like ACE inhibitors, ARBs, and potassium-sparing diuretics.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Board Pearl Summary</div>
            <p class="speakable">Remember: Types 1 and 2 have low potassium. Type 4 has high potassium.</p>
            <p class="speakable">Type 1 has high urine pH because H+ cannot be secreted. Type 4 has low urine pH.</p>
        </div>
    </div>
</div>

<!-- SECTION 16: Hematuria (NEW) -->
<div class="section" data-section="16">
    <div class="section-header" onclick="jumpToSection(16)"><span>17. Hematuria Workup</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Definition</div>
            <p class="speakable">Microscopic hematuria is 3 or more RBCs per high-power field on 2 to 3 properly collected specimens.</p>
            <p class="speakable">Gross hematuria is visible blood in the urine.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Glomerular vs Non-Glomerular</div>
            <p class="speakable">Glomerular hematuria has dysmorphic RBCs, RBC casts, proteinuria, and brown or cola-colored urine without clots.</p>
            <p class="speakable">Non-glomerular hematuria has normal isomorphic RBCs, no RBC casts, minimal proteinuria, pink or red urine, and may have clots.</p>
            <p class="speakable">Board pearl: RBC casts and dysmorphic RBCs indicate glomerular origin. Clots indicate non-glomerular origin.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Glomerular Causes</div>
            <p class="speakable">The most common cause of glomerular hematuria is IgA nephropathy.</p>
            <p class="speakable">Other causes include thin basement membrane disease, also called benign familial hematuria, Alport syndrome, post-infectious GN, lupus nephritis, and ANCA vasculitis.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Non-Glomerular Causes</div>
            <p class="speakable">Kidney causes include stones, renal cell carcinoma, PKD, pyelonephritis, and papillary necrosis.</p>
            <p class="speakable">Bladder causes include cancer, cystitis, and radiation.</p>
            <p class="speakable">Prostate causes include BPH, prostatitis, and prostate cancer.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Workup</div>
            <p class="speakable">First confirm hematuria and rule out false positives from menstruation, myoglobin, or beets.</p>
            <p class="speakable">Then determine origin with UA and microscopy looking for casts and dysmorphic RBCs.</p>
            <p class="speakable">If glomerular, refer to nephrology. If non-glomerular, urology workup with CT urogram and cystoscopy.</p>
            <p class="speakable">Red flags for malignancy include age over 50, smoking history, occupational exposures, and gross hematuria.</p>
        </div>
    </div>
</div>

<!-- SECTION 17: Dialysis & Transplant -->
<div class="section" data-section="17">
    <div class="section-header" onclick="jumpToSection(17)"><span>18. Dialysis & Transplant</span><span>‚ñ∂Ô∏è</span></div>
    <div class="section-content">
        <div class="topic">
            <div class="topic-title">Urgent Dialysis Indications - AEIOU</div>
            <p class="speakable">Remember AEIOU for urgent dialysis indications.</p>
            <p class="speakable">A is for acidosis that is severe and refractory.</p>
            <p class="speakable">E is for electrolytes, specifically refractory hyperkalemia.</p>
            <p class="speakable">I is for ingestions including toxic alcohols, lithium, and aspirin.</p>
            <p class="speakable">O is for overload, meaning refractory volume overload.</p>
            <p class="speakable">U is for uremia with encephalopathy, pericarditis, or bleeding.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Dialysis Modalities</div>
            <p class="speakable">Hemodialysis uses an AV fistula, graft, or catheter. Sessions are typically 3 times weekly for 4 hours.</p>
            <p class="speakable">AV fistula is the best access. Create it 6 months early to allow maturation.</p>
            <p class="speakable">Peritoneal dialysis uses a Tenckhoff catheter. It is done daily at home and preserves residual kidney function.</p>
        </div>
        <div class="topic">
            <div class="topic-title">Transplant</div>
            <p class="speakable">Kidney transplant provides superior survival compared to dialysis and better quality of life.</p>
            <p class="speakable">Living donor transplants have better outcomes than deceased donor.</p>
            <p class="speakable">Immunosuppression includes induction with basiliximab or thymoglobulin, then maintenance with tacrolimus, MMF, and prednisone.</p>
            <p class="speakable">Complications include rejection, infections like CMV and BK virus, malignancy including skin cancer and PTLD, and calcineurin inhibitor nephrotoxicity.</p>
        </div>
    </div>
</div>

</div>

<script>
    // Variables
    let voices = [];
    let currentSectionIndex = 0;
    let currentSentenceIndex = 0;
    let isPlaying = false;
    let allSpeakables = [];
    let speechRate = 1;
    let pauseDuration = 400;
    
    // DOM Elements
    const voiceSelect = document.getElementById('voiceSelect');
    const playBtn = document.getElementById('playBtn');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const backBtn = document.getElementById('backBtn');
    const fwdBtn = document.getElementById('fwdBtn');
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');
    const speedSelect = document.getElementById('speedSelect');
    const pauseInput = document.getElementById('pauseInput');
    
    // Initialize voices - ENGLISH ONLY for iOS compatibility
    function loadVoices() {
        voices = speechSynthesis.getVoices().filter(v => 
            v.lang.startsWith('en-') || v.lang === 'en'
        );
        
        voiceSelect.innerHTML = '';
        voices.forEach((voice, i) => {
            const option = document.createElement('option');
            option.value = i;
            option.textContent = `${voice.name} (${voice.lang})`;
            if (voice.name.includes('Samantha') || voice.name.includes('Daniel')) {
                option.selected = true;
            }
            voiceSelect.appendChild(option);
        });
    }
    
    speechSynthesis.onvoiceschanged = loadVoices;
    loadVoices();
    
    // Collect all speakables
    function collectSpeakables() {
        allSpeakables = Array.from(document.querySelectorAll('.speakable'));
    }
    collectSpeakables();
    
    // Speak function
    function speak(text, callback) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.voice = voices[voiceSelect.value] || voices[0];
        utterance.rate = speechRate;
        utterance.lang = 'en-US';
        
        utterance.onend = () => {
            setTimeout(callback, pauseDuration);
        };
        
        utterance.onerror = (e) => {
            if (e.error !== 'interrupted') {
                console.error('Speech error:', e);
            }
        };
        
        speechSynthesis.speak(utterance);
    }
    
    // Play current sentence
    function playCurrent() {
        if (currentSentenceIndex >= allSpeakables.length) {
            stop();
            return;
        }
        
        // Clear previous highlights
        document.querySelectorAll('.speakable.speaking').forEach(el => el.classList.remove('speaking'));
        
        const current = allSpeakables[currentSentenceIndex];
        current.classList.add('speaking');
        current.scrollIntoView({ behavior: 'smooth', block: 'center' });
        
        // Update section
        const section = current.closest('.section');
        if (section) {
            const sectionIndex = parseInt(section.dataset.section);
            if (sectionIndex !== currentSectionIndex) {
                currentSectionIndex = sectionIndex;
                updateActiveSection();
            }
        }
        
        updateProgress();
        
        speak(current.textContent, () => {
            if (isPlaying) {
                currentSentenceIndex++;
                playCurrent();
            }
        });
    }
    
    // Control functions
    function play() {
        if (isPlaying) {
            pause();
        } else {
            isPlaying = true;
            playBtn.textContent = '‚è∏';
            playCurrent();
        }
    }
    
    function pause() {
        isPlaying = false;
        playBtn.textContent = '‚ñ∂';
        speechSynthesis.cancel();
    }
    
    function stop() {
        pause();
        currentSentenceIndex = 0;
        updateProgress();
    }
    
    function jumpToSection(index) {
        pause();
        currentSectionIndex = index;
        
        // Find first speakable in section
        const section = document.querySelector(`.section[data-section="${index}"]`);
        if (section) {
            section.classList.add('active');
            const firstSpeakable = section.querySelector('.speakable');
            if (firstSpeakable) {
                currentSentenceIndex = allSpeakables.indexOf(firstSpeakable);
            }
        }
        
        updateActiveSection();
        updateProgress();
    }
    
    function updateActiveSection() {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.toc-item').forEach(t => t.classList.remove('active'));
        
        const section = document.querySelector(`.section[data-section="${currentSectionIndex}"]`);
        const tocItem = document.querySelector(`.toc-item[data-section="${currentSectionIndex}"]`);
        
        if (section) section.classList.add('active');
        if (tocItem) tocItem.classList.add('active');
    }
    
    function updateProgress() {
        const percent = (currentSentenceIndex / allSpeakables.length) * 100;
        progressBar.style.width = `${percent}%`;
        progressText.textContent = `${currentSentenceIndex + 1} / ${allSpeakables.length} sentences`;
        savePosition();
    }
    
    function skipSentences(count) {
        pause();
        currentSentenceIndex = Math.max(0, Math.min(allSpeakables.length - 1, currentSentenceIndex + count));
        updateProgress();
        
        // Update section if needed
        const current = allSpeakables[currentSentenceIndex];
        if (current) {
            const section = current.closest('.section');
            if (section) {
                currentSectionIndex = parseInt(section.dataset.section);
                updateActiveSection();
            }
        }
    }
    
    // Event listeners
    playBtn.addEventListener('click', play);
    prevBtn.addEventListener('click', () => jumpToSection(Math.max(0, currentSectionIndex - 1)));
    nextBtn.addEventListener('click', () => jumpToSection(Math.min(17, currentSectionIndex + 1)));
    backBtn.addEventListener('click', () => skipSentences(-5));
    fwdBtn.addEventListener('click', () => skipSentences(5));
    
    speedSelect.addEventListener('change', () => {
        speechRate = parseFloat(speedSelect.value);
    });
    
    pauseInput.addEventListener('change', () => {
        pauseDuration = parseInt(pauseInput.value) || 400;
    });
    
    document.querySelectorAll('.toc-item').forEach(item => {
        item.addEventListener('click', () => {
            jumpToSection(parseInt(item.dataset.section));
        });
    });
    
    // Position memory
    function savePosition() {
        localStorage.setItem('nephro_audio_position', currentSentenceIndex.toString());
    }
    
    function loadPosition() {
        const saved = localStorage.getItem('nephro_audio_position');
        if (saved) {
            currentSentenceIndex = parseInt(saved);
            updateProgress();
        }
    }
    
    // Initialize
    loadPosition();
    jumpToSection(0);
</script>

</body>
</html>
